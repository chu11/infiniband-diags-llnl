.TH IBPORTSTATE 8 "Mar 9, 2011" "OpenIB" "OpenIB Diagnostics"

.SH NAME
ibportstate \- handle port (physical) state and link speed of an InfiniBand port

.SH SYNOPSIS
.B ibportstate
[\-d(ebug)] [\-e(rr_show)] [\-v(erbose)] [\-D(irect)] [\-G(uid)]
[\-s smlid] [\-V(ersion)] [\-C ca_name] [\-P ca_port]
[\-t(imeout) timeout_ms] [\-h(elp)] <dest dr_path|lid|guid> <portnum> [<op>]

.SH DESCRIPTION
.PP
ibportstate allows the port state and port physical state of an IB port
to be queried (in addition to link width and speed being validated
relative to the peer port when the port queried is a switch port),
or a switch port to be disabled, enabled, or reset. It
also allows the link speed/width enabled on any IB port to be adjusted.

.SH OPTIONS

.PP
See infiniband-diags(8) for common options.

.PP
.TP
op
Port operations allowed
 supported ops: enable, disable, reset, speed, espeed, fdr10, width, query,
		down, arm, active, vls, mtu, lid, smlid, lmc
 Default is query
.PP
 ops enable, disable, and reset are only allowed on switch ports
 (An error is indicated if attempted on CA or router ports)
 speed and width ops are allowed on any port
 speed values are legal values for PortInfo:LinkSpeedEnabled
 (An error is indicated if PortInfo:LinkSpeedSupported does not support
  this setting)
 espeed ops are allowed on any port supporting extended link speeds
 fdr10 ops are allowed on any port supporting fdr10
(An error is indicated if port's capability mask indicates extended
 link speeds are not supported or if PortInfo:LinkSpeedExtSupported
 does not support this setting)
 width values are legal values for PortInfo:LinkWidthEnabled
 (An error is indicated if PortInfo:LinkWidthSupported does not support
  this setting)
 (NOTE: Speed and width changes are not effected until the port goes through
  link renegotiation)
 query also validates port characteristics (link width, speed, espeed, and fdr10)
  based on the peer port. This checking is done when the port
  queried is a switch port as it relies on combined routing
  (an initial LID route with directed routing to the peer) which
  can only be done on a switch. This peer port validation feature
  of query op requires LID routing to be functioning in the subnet.


.SH EXAMPLES

.PP
ibportstate 3 1 disable                 # by lid
.PP
ibportstate -G 0x2C9000100D051 1 enable # by guid
.PP
ibportstate -D 0 1                      # (query) by direct route
.PP
ibportstate 3 1 reset				# by lid
.PP
ibportstate 3 1 speed 1				# by lid
.PP
ibportstate 3 1 width 1				# by lid
.PP
ibportstate -D 0 1 lid 0x1234 arm		# by direct route

.SH AUTHOR
.TP
Hal Rosenstock
.RI < hal.rosenstock@gmail.com >
